CC       = @CC@
CFLAGS   = -DHASH @CFLAGS@ @THREADFLAGS@ @FDEFS@ @THREADDEFS@ @DEFS@ @PAPIPREP@ @BITFLAGS@

LIBNAME  = libgpt.a
LIBDIR   = @prefix@/lib
INCDIR   = @prefix@/include
MANDIR   = @prefix@/man/man3
OBJS     = camwrappers.o f_wrappers.o gpt.o util.o threadutil.o @PAPIOBJS@
@SET_MAKE@

$(LIBNAME): $(OBJS)
	ar @ARFLAGS@ $@ $(OBJS)
	rm -f tests/*.o

all: $(LIBNAME) tests/all

install:
	cp $(LIBNAME) $(LIBDIR)
	cp gpt.h gpt.inc $(INCDIR)
	cp man/man3/* $(MANDIR)

uninstall:
	rm $(LIBDIR)/$(LIBNAME) $(INCDIR)/gpt.h $(INCDIR)/gpt.inc

tests/all:
	(cd tests; $(MAKE) all)

clean:
	rm $(OBJS) gpt_papi.o $(LIBNAME)
	(cd tests; $(MAKE) clean)

camwrappers.o: gpt.h private.h
f_wrappers.o: gpt.h private.h
gpt.o: gpt.h private.h
util.o: gpt.h private.h
threadutil.o: gpt.h private.h
gpt_papi.o: gpt.h private.h
