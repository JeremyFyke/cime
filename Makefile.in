CC       = @CC@
CFLAGS   = -DHASH @CFLAGS@ @FDEFS@ @THREADDEFS@ @DEFS@

LIBNAME  = libgpt.a
OBJS     = camwrappers.o f_wrappers.o gpt.o util.o threadutil.o
MAKE     = gmake

all: $(LIBNAME) tests/all

install: @prefix@/$(LIBNAME)
	cp $(LIBNAME) @prefix@/lib

uninstall:
	$(RM) @prefix@/lib/$(LIBNAME) @prefix@/include/gpt.h \
              @prefix@/include/gpt.inc

$(LIBNAME): $(OBJS)
	$(AR) $(ARFLAGS) $@ $(OBJS)
	$(RM) -f tests/*.o

tests/all:
	(cd tests; $(MAKE) all)

clean:
	$(RM) $(OBJS)
	(cd tests; $(MAKE) clean)

camwrappers.o: gpt.h private.h
f_wrappers.o: gpt.h private.h
gpt.o: gpt.h private.h
util.o: gpt.h private.h
threadutil.o: gpt.h private.h
